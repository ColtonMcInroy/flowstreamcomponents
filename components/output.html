<script total>

	exports.name = 'Output';
	exports.group = 'FlowStream';
	exports.version = '1';
	exports.icon = 'fa fa-crosshairs';
	exports.author = 'Peter Å irka';
	exports.config = { name: 'Output' };
	exports.inputs = [{ id: 'data', name: 'Data' }];
	exports.type = 'output';

	exports.make = function(instance, config) {

		var instances = [];

		instance.message = function($) {
			for (var fi of instances)
				fi.process($.data, instance);
			$.destroy();
		};

		instance.flowstream = function(id) {
			instances = [];
			for (var key in MAIN.flowstream.instances) {
				var flow = MAIN.flowstream.instances[key];
				for (var id in flow.meta.flow) {
					var fi = flow.meta.flow[id];
					var ci = flow.meta.components[fi.component];
					if (ci.type === 'input')
						fi.process && instances.push(fi);
				}
			}
		};

		setTimeout(() => instance.flowstream(), 2000);
	};

</script>

<style>
	.ui-flow .f-output { background-color: #E4EDFF; }
	.f-output .name { font-size: 14px; margin: 10px; background-color: #FFF; text-align: center; border: 1px dashed #E0E0E0; padding: 10px; border-radius: var(--radius); }
	.ui-dark .ui-flow .f-output { background-color: #33415F; }
	.ui-dark .f-output .name { background-color: #202020; border-color: #404040; }
</style>


<settings>
	<div class="padding">
		<div data---="input__?.name__required:1">Output name</div>
	</div>
</settings>

<readme>
The component sends data to another Flow.
</readme>

<body>
	<header>
		<i class="fa fa-crosshairs"></i>FlowStream Output
	</header>
	<footer>
		<div class="name" data-bind="?.config.{0}.name__text__empty"></div>
	</footer>
</body>