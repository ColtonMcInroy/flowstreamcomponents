<script total>

	exports.name = 'Input';
	exports.group = 'Common';
	exports.version = '1';
	exports.icon = 'fa fa-filter';
	exports.author = 'Peter Å irka';
	exports.config = { name: '' };
	exports.outputs = [{ id: 'data', name: 'Data', readme: '' }];
	exports.type = 'input';

	exports.make = function(instance, config) {

		var instances = null;

		instance.message = function($) {
			if (instances && instances.length) {
				for (var com of instances)
					com.send($);
			}
		};

		instance.flowstream = function() {
			instances = [];
			for (var key in MAIN.flowstream.instances) {
				var fs = MAIN.flowstream.instances[key];
				for (var fid in fs.meta.flow) {
					var fi = fs.meta.flow[fid];
					var com = fs.meta.components[fi.component];
					if (com.type === 'output2')
						instances.push(fi);
				}
			}
		};

		instance.configure = function() {
			MAIN.flowstream.refresh_io();
		};

		setTimeout(() => instance.flowstream(), 500);
	};

</script>

<settings>
	<div class="padding">
		<div data---="input__?.name__required:1" class="m"><b>Input name</b></div>
		<div data---="textarea__?.readme__monospace:1;height:250">Readme</div>
		<div class="help">Supports markdown format</div>
	</div>
</settings>

<readme>
The component receives data from another Flow.
</readme>

<body>
	<header>
		<i class="fa fa-filter"></i>Input: <b data-bind="?.config.{0}.name__text__empty"></b>
	</header>
</body>